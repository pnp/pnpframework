<pnp:Provisioning xmlns:pnp="http://schemas.dev.office.com/PnP/2022/09/ProvisioningSchema"
                  Author="John White"
                  Generator="Human being"
                  Version="1.0"
                  Description="A sample Provisioning document"
                  DisplayName="Sample Provisioning"
                  ImagePreviewUrl="https://sharepointpnp.com/ImagePreview.png">

  <pnp:Preferences Author="John Black" Version="1.0" Generator="Human being :-)">
    <pnp:Parameters>
      <pnp:Parameter Key="O365TenantName">contoso</pnp:Parameter>
      <pnp:Parameter Key="CodeProvidedParam" Required="true"/>
      <pnp:Parameter Key="YammerNetwork">contoso.com</pnp:Parameter>
      <pnp:Parameter Key="lcid">1033</pnp:Parameter>
      <pnp:Parameter Key="CompanyName">Contoso Inc.</pnp:Parameter>
    </pnp:Parameters>
  </pnp:Preferences>

  <pnp:Localizations DefaultLCID="1040">
    <pnp:Localization LCID="1033" Name="core" ResourceFile="resources-core.en-us.resx" />
    <pnp:Localization LCID="1040" Name="core" ResourceFile="resources-core.it-it.resx" />
    <pnp:Localization LCID="1031" Name="core" ResourceFile="resources-core.de-de.resx" />
    <pnp:Localization LCID="1033" Name="intranet" ResourceFile="resources-intranet.en-us.resx" />
    <pnp:Localization LCID="1040" Name="intranet" ResourceFile="resources-intranet.it-it.resx" />
    <pnp:Localization LCID="1031" Name="intranet" ResourceFile="resources-intranet.de-de.resx" />
  </pnp:Localizations>

  <pnp:Tenant>
    <pnp:SiteDesigns>
      <pnp:SiteDesign IsDefault="true" Title="PnP Site Design" Description="Just a sample" PreviewImageUrl="PnPSiteDesign.png" PreviewImageAltText="PnP Site Design Preview" WebTemplate="CommunicationSite" Overwrite="false">
        <pnp:SiteScripts>
          <pnp:SiteScriptRef ID="{SiteScriptID:PnP Site Script 01}"/>
          <pnp:SiteScriptRef ID="{SiteScriptID:PnP Site Script 03}"/>
        </pnp:SiteScripts>
        <pnp:Grants>
          <pnp:Grant Principal="user1@contoso.com" Right="View" />
          <pnp:Grant Principal="user2@contoso.com" Right="View" />
          <pnp:Grant Principal="user3@contoso.com" Right="None" />
        </pnp:Grants>
      </pnp:SiteDesign>
    </pnp:SiteDesigns>
    <pnp:SiteScripts>
      <pnp:SiteScript Title="PnP Site Script 01" Description="PnP Site Script Sample 01" JsonFilePath=".\pnp-site-script-01.json" Overwrite="true" />
      <pnp:SiteScript Title="PnP Site Script 02" Description="PnP Site Script Sample 02" JsonFilePath=".\pnp-site-script-02.json" Overwrite="false" />
      <pnp:SiteScript Title="PnP Site Script 03" Description="PnP Site Script Sample 03" JsonFilePath=".\pnp-site-script-03.json" />
    </pnp:SiteScripts>
    <pnp:StorageEntities>
      <pnp:StorageEntity Key="PnPKey01" Value="My custom tenant-wide value 01" Comment="Comment 01" Description="Description 01" />
      <pnp:StorageEntity Key="PnPKey02" Value="{ Id: 1, Property: 'Some text here'}" Description="Description 02" />
    </pnp:StorageEntities>
    <pnp:AppCatalog>
      <pnp:Package Src="solution\spfx-discuss-now.sppkg" Action="UploadAndPublish" SkipFeatureDeployment="true" Overwrite="true" />
      <pnp:Package PackageId="d0816f0a-fda4-4a98-8e61-1bbe1f2b5b27" Action="Publish" />
      <pnp:Package PackageId="9672a07b-c111-4a12-bb5b-8d43c2ddd256" Action="Remove" />
    </pnp:AppCatalog>
    <pnp:WebApiPermissions>
      <pnp:WebApiPermission Resource="Microsoft.Graph" Scope="User.ReadBasic.All"/>
      <pnp:WebApiPermission Resource="Microsoft.Graph" Scope="Group.ReadWrite.All"/>
      <pnp:WebApiPermission Resource="MyCustomEnterpriseAPI" Scope="Invoke.Custom.Action"/>
    </pnp:WebApiPermissions>
    <pnp:ContentDeliveryNetwork>
      <pnp:Public Enabled="true" NoDefaultOrigins="true">
        <pnp:Origins>
          <pnp:Origin Url="sites/CDN/CDNFiles" Action="Add"/>
          <pnp:Origin Url="sites/CDN/CDNFiles-Wrong" Action="Remove"/>
        </pnp:Origins>
        <pnp:IncludeFileExtensions>PDF,XML,JPG,JS,PNG</pnp:IncludeFileExtensions>
        <pnp:ExcludeRestrictedSiteClassifications>HBI,GDPR</pnp:ExcludeRestrictedSiteClassifications>
        <pnp:ExcludeIfNoScriptDisabled>JS,CSS</pnp:ExcludeIfNoScriptDisabled>
      </pnp:Public>
      <pnp:Private Enabled="true" NoDefaultOrigins="false">
        <pnp:Origins>
          <pnp:Origin Url="sites/CDNPrivate/CDNFiles" Action="Add"/>
          <pnp:Origin Url="sites/CDNPrivate/CDNFiles-Wrong" Action="Remove"/>
        </pnp:Origins>
        <pnp:IncludeFileExtensions>PDF,XML,JPG,JS,PNG</pnp:IncludeFileExtensions>
        <pnp:ExcludeRestrictedSiteClassifications>HIB,GDPR</pnp:ExcludeRestrictedSiteClassifications>
      </pnp:Private>
    </pnp:ContentDeliveryNetwork>
    <pnp:Themes>
      <pnp:Theme Name="CustomOrange" IsInverted="false" Overwrite="false">
        {
        "themePrimary": "#ecb534",
        "themeLighterAlt": "#fefcf6",
        "themeLighter": "#fcf3dd",
        "themeLight": "#fae8bf",
        "themeTertiary": "#f4d282",
        "themeSecondary": "#efbe4b",
        "themeDarkAlt": "#d5a32f",
        "themeDark": "#b48a28",
        "themeDarker": "#85661d",
        "neutralLighterAlt": "#f8f8f8",
        "neutralLighter": "#f4f4f4",
        "neutralLight": "#eaeaea",
        "neutralQuaternaryAlt": "#dadada",
        "neutralQuaternary": "#d0d0d0",
        "neutralTertiaryAlt": "#c8c8c8",
        "neutralTertiary": "#a9a9a9",
        "neutralSecondary": "#8d8d8d",
        "neutralPrimaryAlt": "#727272",
        "neutralPrimary": "#020202",
        "neutralDark": "#3a3a3a",
        "black": "#1e1e1e",
        "white": "#ffffff",
        "bodyBackground": "#ffffff",
        "bodyText": "#020202"
        }
      </pnp:Theme>
      <pnp:Theme Name="CustomBlue" IsInverted="true">
        {
        "themePrimary": "#316bcf",
        "themeLighterAlt": "#f5f8fd",
        "themeLighter": "#d9e4f7",
        "themeLight": "#bacef0",
        "themeTertiary": "#7ba1e2",
        "themeSecondary": "#467ad4",
        "themeDarkAlt": "#2d60ba",
        "themeDark": "#26519d",
        "themeDarker": "#1c3c74",
        "neutralLighterAlt": "#f8f8f8",
        "neutralLighter": "#f4f4f4",
        "neutralLight": "#eaeaea",
        "neutralQuaternaryAlt": "#dadada",
        "neutralQuaternary": "#d0d0d0",
        "neutralTertiaryAlt": "#c8c8c8",
        "neutralTertiary": "#a9a9a9",
        "neutralSecondary": "#8d8d8d",
        "neutralPrimaryAlt": "#727272",
        "neutralPrimary": "#020202",
        "neutralDark": "#3a3a3a",
        "black": "#1e1e1e",
        "white": "#ffffff",
        "bodyBackground": "#ffffff",
        "bodyText": "#020202"
        }
      </pnp:Theme>
    </pnp:Themes>
    <pnp:SPUsersProfiles>
      <pnp:SPUserProfile TargetUser="user1@contoso.com">
        <pnp:Property Key="Department" Value="IT"/>
        <pnp:Property Key="OfficeLocation" Value="Milan, Italy"/>
        <pnp:Property Key="PhoneNumber" Value="+39-030-123456"/>
      </pnp:SPUserProfile>
      <pnp:SPUserProfile TargetUser="user2@{parameter:O365TenantName}.onmicrosoft.com">
        <pnp:Property Key="Department" Value="HR"/>
        <pnp:Property Key="OfficeLocation" Value="Seattle, WS"/>
        <pnp:Property Key="PhoneNumber" Value="+1-321-123456"/>
      </pnp:SPUserProfile>
      <pnp:SPUserProfile TargetGroup="group01@contoso.com">
        <pnp:Property Key="Department" Value="R&amp;D"/>
        <pnp:Property Key="OfficeLocation" Value="New York, NY"/>
        <pnp:Property Key="PhoneNumber" Value="+1-456-123456"/>
      </pnp:SPUserProfile>
      <pnp:SPUserProfile TargetGroup="group02@{parameter:O365TenantName}.onmicrosoft.com">
        <pnp:Property Key="Department" Value="Production"/>
        <pnp:Property Key="OfficeLocation" Value="Washington, DC"/>
        <pnp:Property Key="PhoneNumber" Value="+1-789-123456"/>
      </pnp:SPUserProfile>
    </pnp:SPUsersProfiles>
    <pnp:Office365GroupLifecyclePolicies>
      <pnp:Office365GroupLifecyclePolicy
        ID="GROUP_LIFECYCLE_01"
        GroupLifetimeInDays="180"
        AlternateNotificationEmails="admin01@contoso.com,admin02@{parameter:O365TenantName}.onmicrosoft.com"
        ManagedGroupTypes="Selected"/>
    </pnp:Office365GroupLifecyclePolicies>
    <pnp:Office365GroupsSettings>
      <pnp:Property Key="UsageGuidelinesUrl" Value="http://aka.ms/SharePointPnP" />
      <pnp:Property Key="ClassificationList" Value="HBI,MBI,LBI,GDPR,TopSecret" />
      <pnp:Property Key="EnableGroupCreation" Value="true" />
      <pnp:Property Key="DefaultClassification" Value="MBI" />
    </pnp:Office365GroupsSettings>
    <pnp:SharingSettings 
      SharingCapability="ExternalUserAndGuestSharing"
      RequireAnonymousLinksExpireInDays="30"
      FileAnonymousLinkType="View"
      FolderAnonymousLinkType="Edit"
      DefaultSharingLinkType="AnonymousAccess"
      PreventExternalUsersFromResharing="true"
      RequireAcceptingAccountMatchInvitedAccount="true"
      SharingDomainRestrictionMode="AllowList"
      AllowedDomainList="contoso.com,contoso-elettronics.com"
      BlockedDomainList="contoso.com,contoso-elettronics.com"
      />
  </pnp:Tenant>

  <pnp:Templates ID="SAMPLE-TEMPLATES">

    <pnp:ProvisioningTemplateFile ID="WORKFLOWSITE" File="ProvisioningSchema-2021-03-ReferenceSample-01.xml" />

    <pnp:ProvisioningTemplateFile ID="ProjectsTemplate" File="ProjectsTemplate.xml" />

    <pnp:ProvisioningTemplateFile ID="MeetingsTemplate" File="MeetingsTemplate.xml" />

    <pnp:ProvisioningTemplate ID="SPECIALTEAM" Version="1.0"
      BaseSiteTemplate="STS#0"
      ImagePreviewUrl="https://preview.png"
      DisplayName="Special Team Site"
      Description="This is a Special Team Site for custom provisioning"
      Scope="RootSite"
      TemplateCultureInfo="1040">

      <pnp:Properties>
        <pnp:Property Key="Something" Value="One property" />
        <pnp:Property Key="SomethingElse" Value="Another property ... Who knows ..." />
      </pnp:Properties>

      <pnp:SitePolicy>HBI</pnp:SitePolicy>

      <pnp:WebSettings
        RequestAccessEmail="someone@company.com"
        NoCrawl="false"
        WelcomePage="/Pages/Home.aspx"
        Title="Site Title"
        Description="Site Description"
        SiteLogo="{sitecollection}/SiteAssets/Logo.png"
        SiteLogoThumbnail="{sitecollection}/SiteAssets/Logo.png"
        AlternateCSS="{sitecollection}/Resources/Themes/Contoso/Contoso.css"
        MasterPageUrl="{sitecollection}/_catalogs/MasterPage/oslo.master"
        CustomMasterPageUrl="{sitecollection}/_catalogs/MasterPage/CustomMaster.master"
        HubSiteUrl="/sites/hubsite"
        CommentsOnSitePagesDisabled="false"
        QuickLaunchEnabled="true"
        MembersCanShare="true"
        ExcludeFromOfflineClient="true"
        DisableFlows="false"
        DisableAppViews="false"
        HorizontalQuickLaunch="true"
        SearchScope="Hub"
        IsMultilingual="true"
        OverwriteTranslationsOnChange="true"
        SearchBoxInNavBar="AllPages"
        SearchCenterUrl="https://contoso.sharepoint.com/sites/SearchCenter">
        <pnp:AlternateUICultures>
          <pnp:AlternateUICulture LCID="1033"/>
          <pnp:AlternateUICulture LCID="1040"/>
          <pnp:AlternateUICulture LCID="1035"/>
        </pnp:AlternateUICultures>
      </pnp:WebSettings>

      <pnp:SiteSettings
        AllowDesigner="true"
        AllowCreateDeclarativeWorkflow="false"
        AllowSaveDeclarativeWorkflowAsTemplate="false"
        AllowSavePublishDeclarativeWorkflow="false"
        SocialBarOnSitePagesDisabled="true"
        SearchBoxInNavBar="ModernOnly"
        ShowPeoplePickerSuggestionsForGuestUsers="true"
        SearchCenterUrl="https://contoso.sharepoint.com/sites/SearchCenter"
        />

      <!--<pnp:Theme Name="CustomOrange" IsInverted="false">
        {
        "themePrimary": "#ecb534",
        "themeLighterAlt": "#fefcf6",
        "themeLighter": "#fcf3dd",
        "themeLight": "#fae8bf",
        "themeTertiary": "#f4d282",
        "themeSecondary": "#efbe4b",
        "themeDarkAlt": "#d5a32f",
        "themeDark": "#b48a28",
        "themeDarker": "#85661d",
        "neutralLighterAlt": "#f8f8f8",
        "neutralLighter": "#f4f4f4",
        "neutralLight": "#eaeaea",
        "neutralQuaternaryAlt": "#dadada",
        "neutralQuaternary": "#d0d0d0",
        "neutralTertiaryAlt": "#c8c8c8",
        "neutralTertiary": "#a9a9a9",
        "neutralSecondary": "#8d8d8d",
        "neutralPrimaryAlt": "#727272",
        "neutralPrimary": "#020202",
        "neutralDark": "#3a3a3a",
        "black": "#1e1e1e",
        "white": "#ffffff",
        "bodyBackground": "#ffffff",
        "bodyText": "#020202"
        }
      </pnp:Theme>-->

      <pnp:Theme Name="CustomOrange" IsInverted="false">
        {
        "themePrimary": "#ecb534",
        "themeLighterAlt": "#fefcf6",
        "themeLighter": "#fcf3dd",
        "themeLight": "#fae8bf",
        "themeTertiary": "#f4d282",
        "themeSecondary": "#efbe4b",
        "themeDarkAlt": "#d5a32f",
        "themeDark": "#b48a28",
        "themeDarker": "#85661d",
        "neutralLighterAlt": "#f8f8f8",
        "neutralLighter": "#f4f4f4",
        "neutralLight": "#eaeaea",
        "neutralQuaternaryAlt": "#dadada",
        "neutralQuaternary": "#d0d0d0",
        "neutralTertiaryAlt": "#c8c8c8",
        "neutralTertiary": "#a9a9a9",
        "neutralSecondary": "#8d8d8d",
        "neutralPrimaryAlt": "#727272",
        "neutralPrimary": "#020202",
        "neutralDark": "#3a3a3a",
        "black": "#1e1e1e",
        "white": "#ffffff",
        "bodyBackground": "#ffffff",
        "bodyText": "#020202"
        }
      </pnp:Theme>

      <pnp:RegionalSettings
        AdjustHijriDays="1"
        AlternateCalendarType="Chinese Lunar"
        CalendarType="Hebrew"
        Collation="5"
        FirstDayOfWeek="Sunday"
        FirstWeekOfYear="1"
        LocaleId="1040"
        ShowWeeks="true"
        Time24="true"
        TimeZone="4"
        WorkDayEndHour="5:00PM"
        WorkDayStartHour="9:00AM"
        WorkDays="62"
        />

      <pnp:SupportedUILanguages>
        <pnp:SupportedUILanguage LCID="1033"/>
        <pnp:SupportedUILanguage LCID="1040"/>
        <pnp:SupportedUILanguage LCID="1031"/>
      </pnp:SupportedUILanguages>

      <pnp:AuditSettings AuditLogTrimmingRetention="50" TrimAuditLog="true">
        <pnp:Audit AuditFlag="CheckIn" />
        <pnp:Audit AuditFlag="CheckOut" />
        <pnp:Audit AuditFlag="Update" />
        <pnp:Audit AuditFlag="View" />
      </pnp:AuditSettings>

      <pnp:PropertyBagEntries>
        <pnp:PropertyBagEntry Key="KEY1" Value="value1" Overwrite="true" />
        <pnp:PropertyBagEntry Key="KEY2" Value="value2" Indexed="true" />
      </pnp:PropertyBagEntries>

      <pnp:Security BreakRoleInheritance="true"
                    CopyRoleAssignments="false"
                    ClearSubscopes="true"
                    AssociatedGroups="Test Value"
                    AssociatedMemberGroup="{parameter:AssociatedMemberGroup}"
                    AssociatedOwnerGroup="{parameter:AssociatedOwnerGroup}"
                    AssociatedVisitorGroup="{parameter:AssociatedVisitorGroup}"
                    RemoveExistingUniqueRoleAssignments="true"
                    ResetRoleInheritance="true" >
        <pnp:AdditionalAdministrators ClearExistingItems="false">
          <pnp:User Name="user@contoso.com"/>
          <pnp:User Name="U_SHAREPOINT_ADMINS"/>
        </pnp:AdditionalAdministrators>
        <pnp:AdditionalOwners ClearExistingItems="true">
          <pnp:User Name="user@contoso.com"/>
          <pnp:User Name="U_SHAREPOINT_ADMINS"/>
        </pnp:AdditionalOwners>
        <pnp:AdditionalMembers>
          <pnp:User Name="user@contoso.com"/>
          <pnp:User Name="U_SHAREPOINT_ADMINS"/>
        </pnp:AdditionalMembers>
        <pnp:AdditionalVisitors>
          <pnp:User Name="user@contoso.com"/>
          <pnp:User Name="U_SHAREPOINT_ADMINS"/>
        </pnp:AdditionalVisitors>
        <pnp:SiteGroups>
          <pnp:SiteGroup
              Title="Power Users"
              Description="Group of Power Users"
              Owner="admin@contoso.com">
            <pnp:Members ClearExistingItems="true">
              <pnp:User Name="user1@contoso.com" />
              <pnp:User Name="user2@contoso.com" />
              <pnp:User Name="user3@contoso.com" />
            </pnp:Members>
          </pnp:SiteGroup>
          <pnp:SiteGroup
            AllowMembersEditMembership="true"
            AllowRequestToJoinLeave="true"
            AutoAcceptRequestToJoinLeave="true"
            Description="Test Group 1"
            OnlyAllowMembersViewMembership="true"
            Owner="user1@contoso.com"
            RequestToJoinLeaveEmailSetting="group1@contoso.com"
            Title="TestGroup1">
            <pnp:Members>
              <pnp:User Name="user1@contoso.com"/>
              <pnp:User Name="user2@contoso.com"/>
            </pnp:Members>
          </pnp:SiteGroup>
        </pnp:SiteGroups>
        <pnp:Permissions>
          <pnp:RoleDefinitions>
            <pnp:RoleDefinition Name="Manage List Items" Description="Allows a user to manage list items">
              <pnp:Permissions>
                <pnp:Permission>ViewListItems</pnp:Permission>
                <pnp:Permission>AddListItems</pnp:Permission>
                <pnp:Permission>EditListItems</pnp:Permission>
                <pnp:Permission>DeleteListItems</pnp:Permission>
              </pnp:Permissions>
            </pnp:RoleDefinition>
          </pnp:RoleDefinitions>
          <pnp:RoleAssignments>
            <pnp:RoleAssignment Principal="Power Users" RoleDefinition="Manage List Items"/>
            <pnp:RoleAssignment Principal="user1@contoso.com" RoleDefinition="Manage List Items"/>
            <pnp:RoleAssignment Principal="user2@contoso.com" RoleDefinition="Full Control"/>
            <pnp:RoleAssignment Principal="user3@contoso.com" RoleDefinition="Full Control" Remove="true"/>
          </pnp:RoleAssignments>
        </pnp:Permissions>
      </pnp:Security>

      <pnp:Navigation EnableTreeView="true" AddNewPagesToNavigation="true" CreateFriendlyUrlsForNewPages="true" EnableAudienceTargeting="false">
        <pnp:GlobalNavigation NavigationType="Managed">
          <pnp:ManagedNavigation
            TermStoreId="{sitecollectiontermstoreid}"
            TermSetId="{sitecollectionnavigationtermsetid}" />
        </pnp:GlobalNavigation>
        <pnp:CurrentNavigation NavigationType="Structural">
          <pnp:StructuralNavigation RemoveExistingNodes="true">
            <pnp:NavigationNode Title="Home" IsExternal="false" Url="Default.aspx" />
            <pnp:NavigationNode Title="Libraries">
              <pnp:NavigationNode Title="Invoices" IsExternal="false" Url="Invoices/Forms/AllItems.aspx" />
              <pnp:NavigationNode Title="Offers" IsExternal="false" Url="Offers/Forms/AllItems.aspx" />
            </pnp:NavigationNode>
            <pnp:NavigationNode Title="Privacy" IsExternal="true" Url="http://www.company.com/privacy/" />
          </pnp:StructuralNavigation>
        </pnp:CurrentNavigation>
        <pnp:SearchNavigation RemoveExistingNodes="false">
          <pnp:NavigationNode Title="Sample Search Node 01" Url="{sitecollection}/pages/search01.aspx" IsExternal="true" /> 
          <pnp:NavigationNode Title="Sample Search Node 02" Url="{sitecollection}/pages/search02.aspx" IsExternal="false" /> 
        </pnp:SearchNavigation>
      </pnp:Navigation>

      <pnp:SiteFields>
        <Field ID="{23203E97-3BFE-40CB-AFB4-07AA2B86BF45}" Type="Text" Name="ProjectID" DisplayName="{localization:intranet:ProjectID}" Group="Base.Foundation.Columns" MaxLength="255" AllowDeletion="TRUE" />
        <Field ID="{B01B3DBC-4630-4ED1-B5BA-321BC7841E3D}" Type="Text" Name="ProjectName" DisplayName="{localization:intranet:ProjectName}" Group="Base.Foundation.Columns" MaxLength="255" AllowDeletion="TRUE" />
        <Field ID="{A5DE9600-B7A6-42DD-A05E-10D4F1500208}" Type="Text" Name="ProjectManager" DisplayName="{localization:intranet:ProjectManager}" Group="Base.Foundation.Columns"  MaxLength="255" AllowDeletion="TRUE" />
        <Field ID="{F1A1715E-6C52-40DE-8403-E9AAFD0470D0}" Type="Text" Name="DocumentDescription" DisplayName="{localization:core:Description}" Group="Base.Foundation.Columns" MaxLength="255" AllowDeletion="TRUE" />
      </pnp:SiteFields>

      <pnp:ContentTypes>
        <pnp:ContentType ID="0x01005D4F34E4BE7F4B6892AEBE088EDD215E"
                      Name="General Project Document"
                      Group="Base Foundation Content Types"
                      Description="General Project Document Content Type"
                      NewFormUrl="/Forms/NewForm.aspx"
                      EditFormUrl="/Forms/EditForm.aspx"
                      DisplayFormUrl="/Forms/DisplayForm.aspx"
                      DisplayFormClientSideComponentId="49b0ccdd-1bdf-47ba-a92f-dfddec265d63"
                      DisplayFormClientSideComponentProperties="{'sampleProperty':'Sample value'}"
                      NewFormClientSideComponentId="7c7c9c44-4dd4-4a2b-8619-beba16e08efa"
                      NewFormClientSideComponentProperties="{'sampleProperty':'Sample value'}"
                      EditFormClientSideComponentId="3c4825e4-4b20-496d-9450-cd76f5135323"
                      EditFormClientSideComponentProperties="{'sampleProperty':'Sample value'}">
          <pnp:FieldRefs>
            <!-- Project ID -->
            <pnp:FieldRef ID="{23203E97-3BFE-40CB-AFB4-07AA2B86BF45}" />
            <!-- Project Name -->
            <pnp:FieldRef ID="{B01B3DBC-4630-4ED1-B5BA-321BC7841E3D}" />
            <!-- Project Manager -->
            <pnp:FieldRef ID="{A5DE9600-B7A6-42DD-A05E-10D4F1500208}" UpdateChildren="false" />
            <!-- Project Description -->
            <pnp:FieldRef ID="{F1A1715E-6C52-40DE-8403-E9AAFD0470D0}" UpdateChildren="true" />
          </pnp:FieldRefs>
          <pnp:DocumentTemplate TargetName="DocumentTemplate.dotx" />
        </pnp:ContentType>

        <pnp:ContentType ID="0x0120D5200039D83CD2C9BA4A4499AEE6BE3562E023"
                         Name="ProjectDocumentSet"
                         Description="Document Set for a Project"
                         Hidden="false" Group="Document Sets Samples"
                         ReadOnly="false" Sealed="false" Overwrite="false" UpdateChildren="true">
          <pnp:FieldRefs>
            <!-- Project ID -->
            <pnp:FieldRef ID="{23203E97-3BFE-40CB-AFB4-07AA2B86BF45}" Name="ProjectID" UpdateChildren="true" />
            <!-- Project Name -->
            <pnp:FieldRef ID="{B01B3DBC-4630-4ED1-B5BA-321BC7841E3D}" />
            <!-- Project Manager -->
            <pnp:FieldRef ID="{A5DE9600-B7A6-42DD-A05E-10D4F1500208}" />
          </pnp:FieldRefs>
          <pnp:DocumentSetTemplate WelcomePage="{sitecollection}/_cts/ProjectDocumentSet/ProjectHomePage.aspx" UpdateChildren="false">
            <pnp:AllowedContentTypes RemoveExistingContentTypes="true">
              <pnp:AllowedContentType ContentTypeID="0x0101" />
              <pnp:AllowedContentType ContentTypeID="0x0120" Name="Folder" Remove="true"/>
              <pnp:AllowedContentType ContentTypeID="0x01005D4F34E4BE7F4B6892AEBE088EDD215E" Name="General Project Document" />
            </pnp:AllowedContentTypes>
            <pnp:DefaultDocuments>
              <pnp:DefaultDocument Name="ProjectMainDocument.docx"
                                   ContentTypeID="0x01005D4F34E4BE7F4B6892AEBE088EDD215E"
                                   FileSourcePath="./ProjectDocumentSet/ProjectMainDocument.docx"/>
              <pnp:DefaultDocument Name="Requirements.docx"
                                   ContentTypeID="0x0101"
                                   FileSourcePath="./ProjectDocumentSet/Requirements.docx"/>
              <pnp:DefaultDocument Name="Tests/TestModel.docx"
                                   ContentTypeID="0x0101"
                                   FileSourcePath="./ProjectDocumentSet/Tests/TestModel.docx"/>
              <pnp:DefaultDocument Name="Tests/Labs.docx"
                                   ContentTypeID="0x0101"
                                   FileSourcePath="./ProjectDocumentSet/Tests/Labs.docx"/>
            </pnp:DefaultDocuments>
            <pnp:SharedFields>
              <pnp:SharedField ID="{23203E97-3BFE-40CB-AFB4-07AA2B86BF45}" Name="ProjectID" />
              <pnp:SharedField ID="{B01B3DBC-4630-4ED1-B5BA-321BC7841E3D}" />
              <pnp:SharedField ID="{A5DE9600-B7A6-42DD-A05E-10D4F1500208}" Remove="false" />
            </pnp:SharedFields>
            <pnp:WelcomePageFields>
              <pnp:WelcomePageField ID="{23203E97-3BFE-40CB-AFB4-07AA2B86BF45}" Name="ProjectID" />
              <pnp:WelcomePageField ID="{B01B3DBC-4630-4ED1-B5BA-321BC7841E3D}" />
              <pnp:WelcomePageField ID="{A5DE9600-B7A6-42DD-A05E-10D4F1500208}" Remove="false" />
            </pnp:WelcomePageFields>
            <pnp:XmlDocuments>
              <XmlDocument NamespaceURI="http://schemas.microsoft.com/office/documentsets/defaultdocuments">
                <DefaultDocuments xmlns="http://schemas.microsoft.com/office/documentsets/defaultdocuments" LastModified="1/1/1 0:00:01 AM" AddSetName="" />
              </XmlDocument>
              <XmlDocument NamespaceURI="http://schemas.microsoft.com/office/documentsets/welcomepageview">
                <WelcomePageView xmlns="http://schemas.microsoft.com/office/documentsets/welcomepageview" LastModified="1/1/1 0:00:01 AM" />
              </XmlDocument>
              <XmlDocument NamespaceURI="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
                <FormTemplates xmlns="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
                  <Display>ListForm</Display>
                  <Edit>ListForm</Edit>
                  <New>DocSetDisplayForm</New>
                </FormTemplates>
              </XmlDocument>
              <XmlDocument NamespaceURI="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms/url">
                <FormUrls xmlns="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms/url">
                  <New>_layouts/15/NewDocSet.aspx</New>
                </FormUrls>
              </XmlDocument>
            </pnp:XmlDocuments>
          </pnp:DocumentSetTemplate>
        </pnp:ContentType>

      </pnp:ContentTypes>

      <pnp:Lists>
        <pnp:ListInstance Title="{parameter:CompanyName} - Projects"
                    Description="Project Documents are stored here"
                    DocumentTemplate=""
                    OnQuickLaunch="true"
                    TemplateType="101"
                    Url="Lists/Projects"
                    EnableVersioning="true"
                    ForceCheckout="true"
                    RemoveExistingContentTypes="false"
                    NoCrawl="true"
                    ListExperience="ClassicExperience"
                    ContentTypesEnabled="true"
                    DefaultDisplayFormUrl="./Forms/Display.aspx"
                    DefaultEditFormUrl="./Forms/Edit.aspx"
                    DefaultNewFormUrl="./Forms/NewItem.aspx"
                    Direction="LTR"
                    DraftVersionVisibility="1"
                    EnableAttachments="false"
                    EnableFolderCreation="true"
                    EnableMinorVersions="true"
                    EnableModeration="false"
                    Hidden="false"
                    ImageUrl="./Images/Sample.png"
                    IrmExpire="true"
                    IrmReject="false"
                    IsApplicationList="false"
                    MaxVersionLimit="10"
                    MinorVersionLimit="10"
                    ReadSecurity="11"
                    TemplateFeatureID="81a7b6a8-c0e9-4819-aea1-8fc8894d3c43"
                    ValidationFormula="sample formula here"
                    ValidationMessage="validation message here"
                    TemplateInternalName="fake-template.stp"
                    EnableAudienceTargeting="true"
                    EnableClassicAudienceTargeting="true">
          <pnp:PropertyBagEntries>
            <pnp:PropertyBagEntry Key="Key1" Value="Value1" />
            <pnp:PropertyBagEntry Key="Key2" Value="Value2" Indexed="true" Overwrite="false" />
            <pnp:PropertyBagEntry Key="Key3" Value="Value3" Indexed="false" />
          </pnp:PropertyBagEntries>
          <pnp:DefaultColumnValues>
            <pnp:DefaultColumnValue Key="Field1" Value="Custom Value 1" />
            <pnp:DefaultColumnValue Key="Field2" Value="Custom Value 2" />
          </pnp:DefaultColumnValues>
          <pnp:ContentTypeBindings>
            <pnp:ContentTypeBinding ContentTypeID="0x01005D4F34E4BE7F4B6892AEBE088EDD215E" Default="true"/>
            <pnp:ContentTypeBinding ContentTypeID="0x0120" Remove="true"/>
          </pnp:ContentTypeBindings>
          <pnp:DataRows KeyColumn="ProjectID" UpdateBehavior="Overwrite">
            <pnp:DataRow>
              <pnp:DataValue FieldName="ProjectID">PRJ01</pnp:DataValue>
              <pnp:DataValue FieldName="ProjectName">Sample Project 01</pnp:DataValue>
              <pnp:DataValue FieldName="ProjectManager">Me</pnp:DataValue>
              <pnp:DataValue FieldName="ProjectDescription">This is a sample Project</pnp:DataValue>
              <pnp:Security>
                <pnp:BreakRoleInheritance CopyRoleAssignments="true" ClearSubscopes="true">
                  <pnp:RoleAssignment Principal="user1@contoso.com" RoleDefinition="Full Control"/>
                  <pnp:RoleAssignment Principal="user2@contoso.com" RoleDefinition="Edit"/>
                  <pnp:RoleAssignment Principal="user3@contoso.com" RoleDefinition="View Only"/>
                </pnp:BreakRoleInheritance>
              </pnp:Security>
              <pnp:Attachments>
                <pnp:Attachment Name="OneAttachment.docx" Src="./Attachments/OneAttachment.docx" />
                <pnp:Attachment Name="AnotherAttachment.pptx" Src="./Attachments/AnotherAttachment.pptx" Overwrite="true" />
              </pnp:Attachments>
            </pnp:DataRow>
            <pnp:DataRow>
              <pnp:DataValue FieldName="ProjectID">PRJ021</pnp:DataValue>
              <pnp:DataValue FieldName="ProjectName">Sample Project 02</pnp:DataValue>
              <pnp:DataValue FieldName="ProjectManager">You</pnp:DataValue>
              <pnp:DataValue FieldName="ProjectDescription">This is another sample Project</pnp:DataValue>
              <pnp:Security>
                <pnp:BreakRoleInheritance CopyRoleAssignments="false" ClearSubscopes="true">
                  <pnp:RoleAssignment Principal="user3@contoso.com" RoleDefinition="Full Control"/>
                  <pnp:RoleAssignment Principal="user2@contoso.com" RoleDefinition="Edit"/>
                  <pnp:RoleAssignment Principal="user1@contoso.com" RoleDefinition="View Only"/>
                </pnp:BreakRoleInheritance>
              </pnp:Security>
            </pnp:DataRow>
          </pnp:DataRows>
          <pnp:FieldDefaults>
            <pnp:FieldDefault FieldName="ProjectName">Default Project Name</pnp:FieldDefault>
            <pnp:FieldDefault FieldName="ProjectManager">[Me]</pnp:FieldDefault>
            <pnp:FieldDefault FieldName="ProjectDescription">Default Project Description</pnp:FieldDefault>
          </pnp:FieldDefaults>
          <pnp:Security>
            <pnp:BreakRoleInheritance CopyRoleAssignments="true" ClearSubscopes="true">
              <pnp:RoleAssignment Principal="Power Users" RoleDefinition="Full Control"/>
              <pnp:RoleAssignment Principal="Guests" RoleDefinition="View Only"/>
            </pnp:BreakRoleInheritance>
          </pnp:Security>
          <pnp:Folders>
            <pnp:Folder Name="SubFolder-01">
              <pnp:Folder Name="SubFolder-01-01">
                <pnp:Folder Name="SubFolder-01-01-01">
                  <pnp:PropertyBagEntries>
                    <pnp:PropertyBagEntry Key="Key1" Value="Value1" Indexed="false" Overwrite="true"/>
                  </pnp:PropertyBagEntries>
                  <pnp:DefaultColumnValues>
                    <pnp:DefaultColumnValue Key="Field1" Value="Custom Value 1" />
                    <pnp:DefaultColumnValue Key="Field2" Value="Custom Value 2" />
                  </pnp:DefaultColumnValues>
                </pnp:Folder>
              </pnp:Folder>
              <pnp:Security>
                <pnp:BreakRoleInheritance CopyRoleAssignments="false" ClearSubscopes="true">
                  <pnp:RoleAssignment Principal="user3@contoso.com" RoleDefinition="Full Control"/>
                  <pnp:RoleAssignment Principal="user2@contoso.com" RoleDefinition="Edit"/>
                  <pnp:RoleAssignment Principal="user1@contoso.com" RoleDefinition="View Only"/>
                </pnp:BreakRoleInheritance>
              </pnp:Security>
            </pnp:Folder>
            <pnp:Folder Name="SubFolder-02">
              <pnp:Folder Name="SubFolder-02-01">
                <pnp:Folder Name="SubFolder-02-01-01">
                  <pnp:Security>
                    <pnp:BreakRoleInheritance CopyRoleAssignments="false" ClearSubscopes="true">
                      <pnp:RoleAssignment Principal="user3@contoso.com" RoleDefinition="Full Control"/>
                      <pnp:RoleAssignment Principal="user2@contoso.com" RoleDefinition="Edit"/>
                      <pnp:RoleAssignment Principal="user1@contoso.com" RoleDefinition="View Only"/>
                    </pnp:BreakRoleInheritance>
                  </pnp:Security>
                </pnp:Folder>
              </pnp:Folder>
            </pnp:Folder>
            <pnp:Folder Name="SubFolder-03" />
            <pnp:Folder Name="Sample-DocumentSet" ContentTypeID="0x0120001234567890">
              <pnp:Properties>
                <pnp:Property Key="CustomProperty01" Value="CustomValue01"/>
                <pnp:Property Key="CustomProperty02" Value="CustomValue02"/>
              </pnp:Properties>
            </pnp:Folder>
          </pnp:Folders>
          <pnp:UserCustomActions>
            <pnp:CustomAction
              Name="CA_LIST_ECB_ITEM"
              Description="Custom Action for ECB in List"
              RegistrationType="ContentType"
              RegistrationId="0x01005D4F34E4BE7F4B6892AEBE088EDD215E"
              Location="EditControlBlock"
              Sequence="1000"
              Rights="EditListItems,AddListItems,DeleteListItems"
              Title="Sample Custom Action"
              Url="https://spmanaged.azurewebsites.net/customAction/?ItemUrl={ItemUrl}&amp;ItemId={ItemId}&amp;ListId={ListId}&amp;SiteUrl={SiteUrl}"
              Enabled="true" />
          </pnp:UserCustomActions>
          <pnp:Webhooks>
            <pnp:Webhook ExpiresInDays="120" ServerNotificationUrl="http://myapp.azurewebsites.net/WebHookListener" ClientState="ABC" />
          </pnp:Webhooks>
          <pnp:IRMSettings
            AllowPrint="true"
            AllowWriteCopy="false"
            AllowScript="true"
            DisableDocumentBrowserView="true"
            DocumentAccessExpireDays="30"
            DocumentLibraryProtectionExpiresInDays="90"
            Enabled="true"
            EnableDocumentAccessExpire="true"
            EnableDocumentBrowserPublishingView="true"
            EnableGroupProtection="false"
            EnableLicenseCacheExpire="false"
            GroupName="Custom IRM Group"
            LicenseCacheExpireDays="60"
            PolicyDescription="Sample IRM Policy"
            PolicyTitle="Sample IRM Policy"
            />
        </pnp:ListInstance>
        <pnp:ListInstance Title="General Documents"
                    Description="Project Documents are stored here"
                    DocumentTemplate=""
                    OnQuickLaunch="true"
                    TemplateType="101"
                    Url="Lists/GeneralDocuments"
                    ReadSecurity="11"
                    WriteSecurity="11"
                    EnableVersioning="true"
                    RemoveExistingContentTypes="true">
          <pnp:ContentTypeBindings>
            <pnp:ContentTypeBinding ContentTypeID="0x01005D4F34E4BE7F4B6892AEBE088EDD215E" Default="true"/>
          </pnp:ContentTypeBindings>
        </pnp:ListInstance>
        <pnp:ListInstance Title="Sample BCS List"
                          Description="List with data via BCS"
                          OnQuickLaunch="true"
                          TemplateType="101"
                          Url="Lists/SampleBCS">
          <pnp:DataSource>
            <pnp:DataSourceItem Key="LobSystemInstance" Value="ODS" />
            <pnp:DataSourceItem Key="EntityNamespace" Value="https://sample.contoso.com/ODS" />
            <pnp:DataSourceItem Key="Entity" Value="ODS.Customer" />
            <pnp:DataSourceItem Key="SpecificFinder" Value="CustomerRead Item" />
          </pnp:DataSource>
        </pnp:ListInstance>
      </pnp:Lists>

      <pnp:Features>
        <pnp:SiteFeatures>
          <pnp:Feature ID="b50e3104-6812-424f-a011-cc90e6327318" Description="Document ID Service (DocID) site collection feature" />
          <pnp:Feature ID="9c0834e1-ba47-4d49-812b-7d4fb6fea211" Description="Search Server Web Parts and Templates (SearchMaster) site collection feature" />
          <pnp:Feature ID="0af5989a-3aea-4519-8ab0-85d91abe39ff" Deactivate="true" Description="Workflows (Workflows) site collection feature" />
        </pnp:SiteFeatures>
        <pnp:WebFeatures>
          <pnp:Feature ID="7201d6a4-a5d3-49a1-8c19-19c4bac6e668" Deactivate="false" Description="Metadata Navigation and Filtering (MetaDataNav) site feature" />
          <pnp:Feature ID="961d6a9c-4388-4cf2-9733-38ee8c89afd4" Description="Community Site Feature (CommunitySite) site feature" />
          <pnp:Feature ID="e2f2bb18-891d-4812-97df-c265afdba297" Description="Project Functionality (ProjectFunctionality) site feature" />
          <pnp:Feature ID="4aec7207-0d02-4f4f-aa07-b370199cd0c7" Deactivate="true" Description="Getting Started (GettingStarted) site feature" />
        </pnp:WebFeatures>
      </pnp:Features>

      <pnp:CustomActions>
        <pnp:SiteCustomActions>
          <!--Must have deployed the Provider Hosted App, for Rights see Microsoft.SharePoint.Client.PermissionKind -->
          <pnp:CustomAction Name="CA_SITE_SETTINGS_SITECLASSIFICATION" Description="Site Classification Application" Group="SiteTasks" Location="Microsoft.SharePoint.SiteSettings" Title="Site Classification" Sequence="1000" Url="https://spmanaged.azurewebsites.net/pages/index.aspx?SPHostUrl={0}" Rights="31" Enabled="true"
                            ClientSideComponentId="70056b07-3a88-4882-989f-eb2f1a74ff5f" ClientSideComponentProperties="{}" />
          <pnp:CustomAction Name="CA_STDMENU_SITECLASSIFICATION" Description="Site Classification Application" Group="SiteActions" Location="Microsoft.SharePoint.StandardMenu" Title="Site Classification" Sequence="1000" Url="https://spmanaged.azurewebsites.net/pages/index.aspx?SPHostUrl={0}" Rights="31" Enabled="true" />
        </pnp:SiteCustomActions>
        <pnp:WebCustomActions>
          <pnp:CustomAction Name="CA_SUBSITE_OVERRIDE" Description="Override new sub-site link" Group="SiteTasks" Location="Microsoft.SharePoint.SiteSettings" Title="SubSite Overide" Sequence="1000" Url="https://spmanaged.azurewebsites.net/pages/index.aspx?SPHostUrl={0}" Rights="31" Enabled="true"/>
        </pnp:WebCustomActions>
      </pnp:CustomActions>

      <pnp:Files>
        <pnp:File Src="Logo.png" Folder="SiteAssets" Overwrite="true" TargetFileName="CompanyLogo.png" />
        <pnp:File Src="CustomPage.aspx" Folder="SitePages" Overwrite="true">
          <pnp:Security>
            <pnp:BreakRoleInheritance CopyRoleAssignments="true" ClearSubscopes="true">
              <pnp:RoleAssignment Principal="Power Users" RoleDefinition="Full Control"/>
            </pnp:BreakRoleInheritance>
          </pnp:Security>
          <pnp:Properties>
            <pnp:Property Key="CustomProperty01" Value="CustomValue01"/>
            <pnp:Property Key="CustomProperty02" Value="CustomValue02"/>
          </pnp:Properties>
        </pnp:File>
        <pnp:File Src="CustomMaster.master" Folder="_catalogs/MasterPage" Overwrite="true" Level="Published" />
        <pnp:File Src="Custom.spcolor" Folder="_catalogs/Theme/15" Overwrite="true" />
        <pnp:File Src="Custom.spfont" Folder="_catalogs/Theme/15" Overwrite="true" />

        <!-- This is the custom WelcomePage for the ProjectDocumentSet ContentType -->
        <pnp:File Src="ProjectHomePage.aspx" Folder="_cts/ProjectDocumentSet/" Overwrite="true" />

        <pnp:Directory Src="c:\LocalPath\StyleLibrary" Folder="Style%20Library" Overwrite="true"
            Recursive="true" IncludedExtensions="*.css,*.js,*.woff" ExcludedExtensions="*.xml,*.json" />
        <pnp:Directory Src=".\Invoices" Folder="Invoices" Overwrite="true"
                    Recursive="false" MetadataMappingFile=".\InvoicesMetadata.json" />
        <pnp:Directory Src="c:\LocalPath\Pages" Folder="{PagesLibrary}"
                    Overwrite="true" Recursive="true" Level="Published"
                    MetadataMappingFile="c:\LocalPath\PagesMetadata.json" />

      </pnp:Files>

      <pnp:Pages>
        <pnp:Page Layout="TwoColumns" Overwrite="true" Url="{site}/SitePages/DemoWikiPage.aspx"></pnp:Page>
        <pnp:Page Layout="OneColumn" Overwrite="true" Url="{site}/SitePages/OneColumnPage.aspx">
          <pnp:Security>
            <pnp:BreakRoleInheritance CopyRoleAssignments="true" ClearSubscopes="true">
              <pnp:RoleAssignment Principal="Power Users" RoleDefinition="Full Control"/>
              <pnp:RoleAssignment Principal="Guests" RoleDefinition="View Only"/>
            </pnp:BreakRoleInheritance>
          </pnp:Security>
        </pnp:Page>
        <pnp:Page Layout="Custom" Overwrite="true" Url="{site}/SitePages/AnotherWikiPage.aspx">
          <pnp:Fields>
            <pnp:Field FieldName="WikiField">
              <![CDATA[
              The Wiki page HTML code here!
              ]]>
            </pnp:Field>
          </pnp:Fields>
          <pnp:WebParts>
            <pnp:WebPart Column="1" Row="1" Title="Script Editor">
              <pnp:Contents>
                <webParts>
                  <webPart xmlns="http://schemas.microsoft.com/WebPart/v3">
                    <metaData>
                      <type name="Microsoft.SharePoint.WebPartPages.ScriptEditorWebPart, Microsoft.SharePoint, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" />
                      <importErrorMessage>Cannot import this Web Part.</importErrorMessage>
                    </metaData>
                    <data>
                      <properties>
                        <property name="ExportMode" type="exportmode">All</property>
                        <property name="HelpUrl" type="string" />
                        <property name="Hidden" type="bool">False</property>
                        <property name="Description" type="string">Allows authors to insert HTML snippets or scripts.</property>
                        <property name="Content" type="string">
                          <![CDATA[
                          <script type="text/javascript">
                          function showAlert(){alert("Hello!")};
                          </script><input type="button" onclick="showAlert();" value="Click me">]]>
                        </property>
                        <property name="CatalogIconImageUrl" type="string" />
                        <property name="Title" type="string">Script Editor</property>
                        <property name="AllowHide" type="bool">True</property>
                        <property name="AllowMinimize" type="bool">True</property>
                        <property name="AllowZoneChange" type="bool">True</property>
                        <property name="TitleUrl" type="string" />
                        <property name="ChromeType" type="chrometype">None</property>
                        <property name="AllowConnect" type="bool">True</property>
                        <property name="Width" type="unit" />
                        <property name="Height" type="unit" />
                        <property name="HelpMode" type="helpmode">Navigate</property>
                        <property name="AllowEdit" type="bool">True</property>
                        <property name="TitleIconImageUrl" type="string" />
                        <property name="Direction" type="direction">NotSet</property>
                        <property name="AllowClose" type="bool">True</property>
                        <property name="ChromeState" type="chromestate">Normal</property>
                      </properties>
                    </data>
                  </webPart>
                </webParts>
              </pnp:Contents>
            </pnp:WebPart>
          </pnp:WebParts>
        </pnp:Page>
      </pnp:Pages>

      <pnp:TermGroups>
        <pnp:TermGroup ID="{0E8F395E-FF58-4D45-9FF7-E331AB728BEB}" Name="{parameter:CompanyName} TermSets">
          <pnp:TermSets>
            <pnp:TermSet Name="Projects" ID="{5880B01B-5D6F-4606-A492-3B03A2FB4DD7}" Language="1040">
              <pnp:Terms>
                <pnp:Term Name="IT Projects" ID="{3D212FC2-F176-4621-AED1-128219666D95}">
                  <pnp:CustomProperties>
                    <pnp:Property Key="Property1" Value="Value1" />
                    <pnp:Property Key="Property2" Value="Value2" />
                  </pnp:CustomProperties>
                  <pnp:LocalCustomProperties>
                    <pnp:Property Key="LocalProperty1" Value="Value1" />
                    <pnp:Property Key="LocalProperty2" Value="Value2" />
                  </pnp:LocalCustomProperties>
                  <pnp:Terms>
                    <pnp:Term Name="Cloud" ID="{87C55100-8316-4DA0-97FD-FEB5731880F6}">
                      <pnp:Labels>
                        <pnp:Label Language="1040" Value="Nuvola"/>
                      </pnp:Labels>
                    </pnp:Term>
                    <pnp:Term Name="New Farm" ID="{C422BD0D-681D-448F-A41E-C71C473A95CC}" IsDeprecated="true">
                      <pnp:Labels>
                        <pnp:Label Language="1040" Value="Nuova Farm"/>
                      </pnp:Labels>
                    </pnp:Term>
                  </pnp:Terms>
                </pnp:Term>
                <pnp:Term Name="HSE Projects" ID="{1F1B9EE8-74EA-4D89-B502-FEAA44340385}">
                  <pnp:Terms>
                    <pnp:Term Name="Security Assessment" ID="{3279FE80-95DB-4D35-B235-A9B2F0FB6F9E}">
                      <pnp:Labels>
                        <pnp:Label Language="1040" Value="Valutazione Sicurezza"/>
                      </pnp:Labels>
                    </pnp:Term>
                    <pnp:Term Name="Safety Program" ID="{FBEA36EA-A750-4A97-9667-5D51A6C895AF}">
                      <pnp:Labels>
                        <pnp:Label Language="1040" Value="Programma Sicurezza"/>
                      </pnp:Labels>
                    </pnp:Term>
                  </pnp:Terms>
                </pnp:Term>
              </pnp:Terms>
            </pnp:TermSet>
          </pnp:TermSets>
          <pnp:Contributors>
            <pnp:User Name="user1@contoso.com"/>
          </pnp:Contributors>
          <pnp:Managers>
            <pnp:User Name="user2@contoso.com"/>
            <pnp:User Name="user3@contoso.com"/>
          </pnp:Managers>
        </pnp:TermGroup>
      </pnp:TermGroups>

      <pnp:ComposedLook Name="Custom Look" Version="1"
        BackgroundFile="{sitecollection}/Resources/Themes/Contoso/contosobg.jpg"
        ColorFile="{sitecollection}/_catalogs/Theme/15/Custom.spcolor"
        FontFile="{sitecollection}/_catalogs/Theme/15/Custom.spfont"/>

      <!--
      <pnp:Workflows>
        <pnp:WorkflowDefinitions>
          <pnp:WorkflowDefinition Id="{72756D8D-2F0C-4DA0-83BB-4E496E60F443}"
              DisplayName="Sample-Workflow-Definition"
              Description="This is a sample Workflow Definition"
              DraftVersion="1"
              InitiationUrl=""
              AssociationUrl=""
              Published="true"
              RequiresInitiationForm="false"
              RequiresAssociationForm="false"
              RestrictToType="List"
              RestrictToScope="{8486EF59-377B-43BB-AD48-93A9BA6182C8}"
              XamlPath="SampleWorkflow.xaml">
            <pnp:FormField />
          </pnp:WorkflowDefinition>

        </pnp:WorkflowDefinitions>

        <pnp:WorkflowSubscriptions>
          <pnp:WorkflowSubscription
            DefinitionId="{72756D8D-2F0C-4DA0-83BB-4E496E60F443}"
            ListId="{listid:General Documents}"
            Enabled="true"
            EventSourceId="{listid:General Documents}"
            ItemAddedEvent="true" ItemUpdatedEvent="false" WorkflowStartEvent="true"
            ManualStartBypassesActivationLimit="false"
            Name="Sample Workflow" StatusFieldName="SampleWorkflowStatus" ParentContentTypeId="">
            <pnp:PropertyDefinitions>
              <pnp:PropertyDefinition Key="StatusColumnCreated" Value="0" />
              <pnp:PropertyDefinition Key="WSPublishState" Value="1" />
              <pnp:PropertyDefinition Key="StatusFieldName" Value="SampleWorkflowStatus" />
            </pnp:PropertyDefinitions>
          </pnp:WorkflowSubscription>
        </pnp:WorkflowSubscriptions>
        
      </pnp:Workflows>
-->

      <pnp:SearchSettings>
        <pnp:SiteSearchSettings>
          <SearchConfigurationSettings xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/Microsoft.Office.Server.Search.Portability">
            <SearchQueryConfigurationSettings>
              <SearchQueryConfigurationSettings>
                <BestBets xmlns:d4p1="http://www.microsoft.com/sharepoint/search/KnownTypes/2008/08" />
                <DefaultSourceId>00000000-0000-0000-0000-000000000000</DefaultSourceId>
                <DefaultSourceIdSet>true</DefaultSourceIdSet>
                <DeployToParent>false</DeployToParent>
                <DisableInheritanceOnImport>false</DisableInheritanceOnImport>
                <QueryRuleGroups xmlns:d4p1="http://www.microsoft.com/sharepoint/search/KnownTypes/2008/08" />
                <QueryRules xmlns:d4p1="http://www.microsoft.com/sharepoint/search/KnownTypes/2008/08" />
                <ResultTypes xmlns:d4p1="http://schemas.datacontract.org/2004/07/Microsoft.Office.Server.Search.Administration" />
                <Sources xmlns:d4p1="http://schemas.datacontract.org/2004/07/Microsoft.Office.Server.Search.Administration.Query" />
                <UserSegments xmlns:d4p1="http://www.microsoft.com/sharepoint/search/KnownTypes/2008/08" />
              </SearchQueryConfigurationSettings>
            </SearchQueryConfigurationSettings>
            <SearchRankingModelConfigurationSettings>
              <RankingModels xmlns:d3p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" />
            </SearchRankingModelConfigurationSettings>
            <SearchSchemaConfigurationSettings>
              <Aliases xmlns:d3p1="http://schemas.datacontract.org/2004/07/Microsoft.Office.Server.Search.Administration">
                <d3p1:LastItemName i:nil="true" />
                <d3p1:dictionary xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" />
              </Aliases>
              <CategoriesAndCrawledProperties xmlns:d3p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" />
              <CrawledProperties xmlns:d3p1="http://schemas.datacontract.org/2004/07/Microsoft.Office.Server.Search.Administration" i:nil="true" />
              <ManagedProperties xmlns:d3p1="http://schemas.datacontract.org/2004/07/Microsoft.Office.Server.Search.Administration">
                <d3p1:LastItemName i:nil="true" />
                <d3p1:dictionary xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" />
                <d3p1:TotalCount>0</d3p1:TotalCount>
              </ManagedProperties>
              <Mappings xmlns:d3p1="http://schemas.datacontract.org/2004/07/Microsoft.Office.Server.Search.Administration">
                <d3p1:LastItemName i:nil="true" />
                <d3p1:dictionary xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" />
              </Mappings>
              <Overrides xmlns:d3p1="http://schemas.datacontract.org/2004/07/Microsoft.Office.Server.Search.Administration">
                <d3p1:LastItemName i:nil="true" />
                <d3p1:dictionary xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" />
              </Overrides>
            </SearchSchemaConfigurationSettings>
          </SearchConfigurationSettings>
        </pnp:SiteSearchSettings>
      </pnp:SearchSettings>

      <pnp:Publishing AutoCheckRequirements="MakeCompliant">
        <pnp:DesignPackage DesignPackagePath="CustomDesign.wsp"
                           MajorVersion="1"
                           MinorVersion="0"
                           PackageGuid="{A3349210-5283-44A5-A23F-00F489EB690B}"
                           PackageName="Custom Design"/>
        <pnp:AvailableWebTemplates>
          <pnp:WebTemplate LanguageCode="1033" TemplateName="STS#0" />
          <pnp:WebTemplate TemplateName="BLOG#0" />
        </pnp:AvailableWebTemplates>
        <pnp:PageLayouts Default="SimplePage.aspx">
          <pnp:PageLayout Path="News.aspx" />
          <pnp:PageLayout Path="SimplePage.aspx" />
          <pnp:PageLayout Path="Product.aspx" />
        </pnp:PageLayouts>
        <pnp:ImageRenditions>
          <pnp:ImageRendition Width="100" Height="100" Name="SmallSquare"/>
          <pnp:ImageRendition Width="500" Height="200" Name="SmallRectangle"/>
        </pnp:ImageRenditions>
      </pnp:Publishing>

      <pnp:ApplicationLifecycleManagement>
        <pnp:AppCatalog>
          <pnp:Package Src="solution\spfx-discuss-now.sppkg" Action="UploadAndPublish" SkipFeatureDeployment="true" Overwrite="true" />
          <pnp:Package PackageId="d0816f0a-fda4-4a98-8e61-1bbe1f2b5b27" Action="Publish" />
          <pnp:Package PackageId="9672a07b-c111-4a12-bb5b-8d43c2ddd256" Action="Remove" />
        </pnp:AppCatalog>
        <pnp:Apps>
          <pnp:App AppId="d0816f0a-fda4-4a98-8e61-1bbe1f2b5b27" Action="InstallOrUpdate" SyncMode="Synchronously" />
          <pnp:App AppId="{AppPackageId:spfx-discuss-now}" Action="Update" SyncMode="Asynchronously" />
          <pnp:App AppId="9672a07b-c111-4a12-bb5b-8d43c2ddd256" Action="Uninstall" />
        </pnp:Apps>
      </pnp:ApplicationLifecycleManagement>

      <pnp:Providers>
        <pnp:Provider HandlerType="OfficeDev.PnP.Provisioning.Providers.FakeProvider, OfficeDev.PnP.Provisioning.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" Enabled="true">
          <pnp:Configuration>
            <MyProviderConfiguration id="SampleConfig" xmlns="http://schemas.somecompany.com/MyProviderConfiguration">
              <ChildNode Attribute="value">TextContent</ChildNode>
            </MyProviderConfiguration>
          </pnp:Configuration>
        </pnp:Provider>
        <pnp:Provider HandlerType="MySampleProviderNode.js" Enabled="true">
          <pnp:Configuration>
            fsdfsdfsd
          </pnp:Configuration>
        </pnp:Provider>
      </pnp:Providers>

      <pnp:SiteWebhooks>
        <pnp:Webhook ServerNotificationUrl="http://myapp.azurewebsites.net/WebHookListener" ExpiresInDays="120" SiteWebhookType="WebCreated" ClientState="DEF" />
        <pnp:Webhook ServerNotificationUrl="http://myapp.azurewebsites.net/WebHookListener" ExpiresInDays="120" SiteWebhookType="WebDeleted" />
      </pnp:SiteWebhooks>
        
      <pnp:ClientSidePages>
        <pnp:ClientSidePage PageName="SamplePage" PromoteAsTemplate="true" PromoteAsNewsArticle="true" Overwrite="true" Publish="true" Layout="Article" EnableComments="true" Title="Client Side Page Title" ContentTypeID="0x01010012345" ThumbnailUrl="images/pageThumbnail.png" CreateTranslations="true">
          <pnp:Header Type="Custom"
              ServerRelativeImageUrl="./site%20assets/picture.png"
              TranslateX="10.56"
              TranslateY="15.12345"
              LayoutType="FullWidthImage"
              TextAlignment="Center"
              AlternativeText="Alternate text"
              Authors="John Black, Mike White"
              AuthorByLine="Bill Green"
              AuthorByLineId="5"
              ShowPublishDate="true"
              ShowTopicHeader="true"
              TopicHeader="Topic header value"
              ShowBackgroundGradient="true"                      
          />
          <pnp:Sections>
            <pnp:Section Order="1" Type="OneColumn" BackgroundEmphasis="Neutral"
              Collapsible="true"
              DisplayName="My collapsible section"
              IconAlignment="Left"
              IsExpanded="true"
              ShowDividerLine="true"
              VerticalSectionEmphasis="Neutral">
              <pnp:Controls>
                <pnp:CanvasControl
                  WebPartType="Image"
                  CustomWebPartName="..."
                  JsonControlData="{}"
                  ControlId="0eaba53f-55d8-44b5-9f7c-61301c7f1e0e"
                  Order="1">
                  <pnp:CanvasControlProperties>
                    <pnp:CanvasControlProperty Key="Key1" Value="{token}" />
                  </pnp:CanvasControlProperties>
                </pnp:CanvasControl>
              </pnp:Controls>
            </pnp:Section>
          </pnp:Sections>
          <pnp:FieldValues>
            <pnp:FieldValue Key="Category" Value="Marketing" />
            <pnp:FieldValue Key="Tags" Value="Tag01,Tag02,Tag03" />
          </pnp:FieldValues>
          <pnp:Security>
            <pnp:BreakRoleInheritance CopyRoleAssignments="false" ClearSubscopes="true">
              <pnp:RoleAssignment Principal="user1@contoso.com" RoleDefinition="Full Control"/>
              <pnp:RoleAssignment Principal="user2@contoso.com" RoleDefinition="Edit"/>
              <pnp:RoleAssignment Principal="user3@contoso.com" RoleDefinition="View Only"/>
            </pnp:BreakRoleInheritance>
          </pnp:Security>
          <pnp:Properties>
            <pnp:Property Key="Key01" Value="Value 01" />
            <pnp:Property Key="Key02" Value="Value 02" />
            <pnp:Property Key="Key03" Value="Value 03" />
          </pnp:Properties>
          <pnp:Translations>
            <pnp:ClientSidePage LCID="1036">
              <pnp:Header Type="Default" LayoutType="NoImage" />
            </pnp:ClientSidePage>
            <pnp:ClientSidePage LCID="1040" />
            <pnp:ClientSidePage LCID="1035" />
          </pnp:Translations>
        </pnp:ClientSidePage>
        <pnp:ClientSidePage PageName="SamplePageWithVerticalSection" PromoteAsTemplate="true" PromoteAsNewsArticle="true" Overwrite="true" Publish="true" Layout="Article" EnableComments="true" Title="Client Side Page Title" ContentTypeID="0x01010012345">
          <pnp:Header Type="Custom"
              ServerRelativeImageUrl="./site%20assets/picture.png"
              TranslateX="10.56"
              TranslateY="15.12345"
              LayoutType="FullWidthImage"
              TextAlignment="Center"
              AlternativeText="Alternate text"
              Authors="John Black, Mike White"
              AuthorByLine="Bill Green"
              AuthorByLineId="5"
              ShowPublishDate="true"
              ShowTopicHeader="true"
              TopicHeader="Topic header value"
          />
          <pnp:Sections>
            <pnp:Section Order="1" Type="TwoColumnLeftVerticalSection" BackgroundEmphasis="Neutral" VerticalSectionEmphasis="Strong">
              <pnp:Controls>
                <pnp:CanvasControl
                  WebPartType="Image"
                  CustomWebPartName="..."
                  JsonControlData="{}"
                  ControlId="0eaba53f-55d8-44b5-9f7c-61301c7f1e0e"
                  Order="1">
                  <pnp:CanvasControlProperties>
                    <pnp:CanvasControlProperty Key="" Value="{token}" />
                  </pnp:CanvasControlProperties>
                </pnp:CanvasControl>
              </pnp:Controls>
            </pnp:Section>
          </pnp:Sections>
        </pnp:ClientSidePage>
      </pnp:ClientSidePages>

      <pnp:Header Layout="Standard" MenuStyle="MegaMenu" BackgroundEmphasis="Soft" ShowSiteTitle="true" ShowSiteNavigation="true" />
      
      <pnp:Footer Enabled="true" BackgroundEmphasis="Soft" Logo="logo.png" Name="FooterName" RemoveExistingNodes="true" Layout="Simple" DisplayName="Custom footer">
        <pnp:FooterLinks>
          <pnp:FooterLink DisplayName="Link 01" Url="www.link01.com" />
          <pnp:FooterLink DisplayName="Link 02" Url="www.link02.com" />
          <pnp:FooterLink DisplayName="Link 03" Url="www.link03.com" />
          <pnp:FooterLink DisplayName="Link Master 04">
            <pnp:FooterLink DisplayName="Child Link 04-01" Url="www.link04-01.com" />
            <pnp:FooterLink DisplayName="Child Link 04-02" Url="www.link04-02.com" />
            <pnp:FooterLink DisplayName="Child Link 04-03" Url="www.link04-03.com" />
          </pnp:FooterLink>
          <pnp:FooterLink DisplayName="Link Master 05">
            <pnp:FooterLink DisplayName="Child Link 05-01" Url="www.link05-01.com" />
            <pnp:FooterLink DisplayName="Child Link 05-02" Url="www.link05-02.com" />
          </pnp:FooterLink>
          <pnp:FooterLink DisplayName="Link Master 06">
            <pnp:FooterLink DisplayName="Child Link 06-01">
              <pnp:FooterLink DisplayName="Child Link 06-01-01" Url="www.link06-01-01.com" />
              <pnp:FooterLink DisplayName="Child Link 06-01-02" Url="www.link06-01-02.com" />
            </pnp:FooterLink>
            <pnp:FooterLink DisplayName="Child Link 06-02" Url="www.link06-02.com" />
          </pnp:FooterLink>
        </pnp:FooterLinks>
      </pnp:Footer>

      <pnp:ProvisioningTemplateWebhooks>
        <pnp:ProvisioningTemplateWebhook Url="https://mywebhook.azurefunctions.net/function01?par1={WebhookParam:Param01}&amp;site={sitecollection}&amp;par2={WebhookParam:Param02}&amp;par3={WebhookParam:Param03}"
                                         Method="GET" Kind="ProvisioningTemplateStarted">
          <pnp:Parameters>
            <pnp:Parameter Key="Param01" Value="Value01"/>
            <pnp:Parameter Key="Param02" Value="Value02"/>
            <pnp:Parameter Key="Param03" Value="Value03"/>
          </pnp:Parameters>
        </pnp:ProvisioningTemplateWebhook>
        <pnp:ProvisioningTemplateWebhook Url="https://mywebhook.azurefunctions.net/function01"
                                         Method="POST" Kind="ProvisioningTemplateCompleted" BodyFormat="Json" Async="true">
          <pnp:Parameters>
            <pnp:Parameter Key="Param01" Value="Value01"/>
            <pnp:Parameter Key="Site" Value="{sitecollection}"/>
          </pnp:Parameters>
        </pnp:ProvisioningTemplateWebhook>
      </pnp:ProvisioningTemplateWebhooks>

    </pnp:ProvisioningTemplate>

  </pnp:Templates>

  <pnp:Sequence ID="SAMPLE-SEQUENCE">

    <pnp:SiteCollections>
      <!-- Let's create a Site Collection -->
      <pnp:SiteCollection xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="pnp:CommunicationSite"
                          ProvisioningId="SITE.01"
                          Url="https://{parameter:O365TenantName}.sharepoint.com/sites/CommSite"
                          Title="{parameter:CompanyName} Intranet"
                          Owner="{parameter:CommunicationSiteOwner}"
                          SiteDesign="{SiteDesignId:PnP Site Design}"
                          AllowFileSharingForGuestUsers="true"
                          IsHubSite="true"
                          HubSiteLogoUrl="logo.png"
                          HubSiteTitle="Hub Title"
                          Classification="HBI"
                          Theme="CustomOrange"
                          Description="{parameter:CompanyName} Intranet"
                          Language="1040">
        <pnp:Templates>
          <!-- And let's use the SPECIALTEAM SharePointProvisioningTemplate -->
          <pnp:ProvisioningTemplateReference ID="SPECIALTEAM" />
        </pnp:Templates>
        <pnp:Sites>
          <!-- Now create a Site into the previously created Site Collection -->
          <pnp:Site xsi:type="pnp:TeamSubSiteNoGroup"
                    ProvisioningId="SITE.01.01"
                    Url="{parameter:SitePrefix}-Workflows"
                    Title="{parameter:CompanyName} Intranet Workflows"
                    Description="{parameter:CompanyName} Intranet Workflows"
                    TimeZoneId="4"
                    Language="1040"
                    Theme="CustomBlue"
                    QuickLaunchEnabled="true"
                    UseSamePermissionsAsParentSite="true">
            <pnp:Sites>
              <pnp:Site xsi:type="pnp:TeamSubSiteNoGroup"
                        ProvisioningId="SITE.01.01.01"
                        Url="{parameter:SitePrefix}-Workflows-Sub1"
                        Title="{parameter:CompanyName} Intranet Workflows Sub1"
                        Description="{parameter:CompanyName} Intranet Workflows Sub1"
                        TimeZoneId="4"
                        Language="1040"
                        Theme="CustomOrange"
                        QuickLaunchEnabled="true"
                        UseSamePermissionsAsParentSite="true">
                <pnp:Sites>
                  <pnp:Site xsi:type="pnp:TeamSubSiteNoGroup"
                            ProvisioningId="SITE.01.01.01.01"
                            Url="{parameter:SitePrefix}-Workflows-Sub1.1"
                            Title="{parameter:CompanyName} Intranet Workflows Sub1.1"
                            Description="{parameter:CompanyName} Intranet Workflows Sub1.1"
                            TimeZoneId="4"
                            Language="1040"
                            QuickLaunchEnabled="true"
                            UseSamePermissionsAsParentSite="true">
                    <pnp:Templates>
                      <pnp:ProvisioningTemplateReference ID="WORKFLOWSITE" />
                    </pnp:Templates>
                  </pnp:Site>
                </pnp:Sites>
                <pnp:Templates>
                  <pnp:ProvisioningTemplateReference ID="WORKFLOWSITE" />
                </pnp:Templates>
              </pnp:Site>
              <pnp:Site xsi:type="pnp:TeamSubSiteNoGroup"
                        ProvisioningId="SITE.01.01.02"
                        Url="{parameter:SitePrefix}-Workflows-Sub2"
                        Title="{parameter:CompanyName} Intranet Workflows Sub2"
                        Description="{parameter:CompanyName} Intranet Workflows Sub2"
                        TimeZoneId="4"
                        Language="1040"
                        Theme="CustomBlue"
                        QuickLaunchEnabled="true"
                        UseSamePermissionsAsParentSite="true">
                <pnp:Templates>
                  <pnp:ProvisioningTemplateReference ID="WORKFLOWSITE" />
                </pnp:Templates>
              </pnp:Site>
            </pnp:Sites>
            <pnp:Templates>
              <pnp:ProvisioningTemplateReference ID="WORKFLOWSITE" />
            </pnp:Templates>
          </pnp:Site>
        </pnp:Sites>
      </pnp:SiteCollection>

      <pnp:SiteCollection xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="pnp:TeamSite"
                          ProvisioningId="SITE.02"
                          Title="{parameter:CompanyName} Projects"
                          Alias="Projects"
                          DisplayName="{parameter:CompanyName} Projects"
                          IsPublic="true"
                          IsHubSite="true"
                          Description="{parameter:CompanyName} Projects"
                          Classification="MBI"
                          Teamify="false"
                          HideTeamify="true"
                          Language="1033"
                          GroupLifecyclePolicyId="GROUP_LIFECYCLE_01"
                          SiteDesign="Demo Site Design ID">
        <pnp:Templates>
          <pnp:ProvisioningTemplateReference ID="ProjectsTemplate" />
        </pnp:Templates>
      </pnp:SiteCollection>

      <pnp:SiteCollection xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="pnp:TeamSiteNoGroup"
                          ProvisioningId="SITE.03"
                          Title="{parameter:CompanyName} Meetings"
                          Url="https://{parameter:O365TenantName}.sharepoint.com/sites/Meetings"
                          Owner="{parameter:TeamSiteNoGroupOwner}"
                          Description="{parameter:CompanyName} Intranet Meetings"
                          IsHubSite="false"
                          Language="1040"
                          Theme="CustomOrange"
                          TimeZoneId="4"
                          Groupify="true"
                          Alias="{parameter:CompanyName}Meetings"
                          Classification="HBI"
                          IsPublic="true"
                          KeepOldHomePage="false">
        <pnp:Templates>
          <pnp:ProvisioningTemplateReference ID="MeetingsTemplate" />
        </pnp:Templates>
      </pnp:SiteCollection>
    </pnp:SiteCollections>

    <!-- Provision the TermStore -->
    <pnp:TermStore>
      <pnp:TermGroup ID="{0E8F395E-FF58-4D45-9FF7-E331AB728BEB}" Name="{parameter:CompanyName} TermSets">
        <pnp:TermSets>
          <pnp:TermSet Name="Projects" ID="{5880B01B-5D6F-4606-A492-3B03A2FB4DD7}">
            <pnp:Terms>
              <pnp:Term Name="IT Projects" ID="{3D212FC2-F176-4621-AED1-128219666D95}">
                <pnp:CustomProperties>
                  <pnp:Property Key="Property1" Value="Value1" />
                  <pnp:Property Key="Property2" Value="Value2" />
                </pnp:CustomProperties>
                <pnp:LocalCustomProperties>
                  <pnp:Property Key="LocalProperty1" Value="Value1" />
                  <pnp:Property Key="LocalProperty2" Value="Value2" />
                </pnp:LocalCustomProperties>
                <pnp:Terms>
                  <pnp:Term Name="Cloud" ID="{87C55100-8316-4DA0-97FD-FEB5731880F6}">
                    <pnp:Labels>
                      <pnp:Label Language="1040" Value="Nuvola"/>
                    </pnp:Labels>
                  </pnp:Term>
                  <pnp:Term Name="New Farm" ID="{C422BD0D-681D-448F-A41E-C71C473A95CC}">
                    <pnp:Labels>
                      <pnp:Label Language="1040" Value="Nuova Farm"/>
                    </pnp:Labels>
                  </pnp:Term>
                </pnp:Terms>
              </pnp:Term>
              <pnp:Term Name="HSE Projects" ID="{1F1B9EE8-74EA-4D89-B502-FEAA44340385}">
                <pnp:Terms>
                  <pnp:Term Name="Security Assessment" ID="{3279FE80-95DB-4D35-B235-A9B2F0FB6F9E}">
                    <pnp:Labels>
                      <pnp:Label Language="1040" Value="Valutazione Sicurezza"/>
                    </pnp:Labels>
                  </pnp:Term>
                  <pnp:Term Name="Safety Program" ID="{FBEA36EA-A750-4A97-9667-5D51A6C895AF}">
                    <pnp:Labels>
                      <pnp:Label Language="1040" Value="Programma Sicurezza"/>
                    </pnp:Labels>
                  </pnp:Term>
                </pnp:Terms>
              </pnp:Term>
            </pnp:Terms>
          </pnp:TermSet>
        </pnp:TermSets>
      </pnp:TermGroup>
    </pnp:TermStore>

  </pnp:Sequence>

  <pnp:Teams>
    
    <pnp:TeamTemplate DisplayName="Team from Template 01" Description="Sample Team from Template"
                      Classification="Custom" Visibility="Public">
      <![CDATA[
        { here goes the team template JSON }
      ]]>
    </pnp:TeamTemplate>
    
    <pnp:Team DisplayName="Sample Team 01" Description="This is just a sample Team 01" HiddenGroupMembershipEnabled="true"
              Visibility="Public" CloneFrom="{o365groupid:GroupMailNickname}" MailNickname="cloned-team-03">
      <pnp:Security AllowToAddGuests="true">
        <pnp:Owners ClearExistingItems="true">
          <pnp:User UserPrincipalName="owner01@domain.onmicrosoft.com" />
          <pnp:User UserPrincipalName="owner02@domain.onmicrosoft.com" />
        </pnp:Owners>
        <pnp:Members ClearExistingItems="false">
          <pnp:User UserPrincipalName="user01@domain.onmicrosoft.com" />
          <pnp:User UserPrincipalName="user02@domain.onmicrosoft.com" />
          <pnp:User UserPrincipalName="user03@domain.onmicrosoft.com" />
        </pnp:Members>
      </pnp:Security>
    </pnp:Team>
    <pnp:Team GroupId="{o365groupid:GroupMailNickname}" DisplayName="Sample Team 02" Description="This is just a sample Team 02" Classification="Private"
              Specialization="EducationStandard" TargetSiteUrl="{sequenceSiteUrl:Id}" ProvisioningTemplateId="SPECIALTEAM" Visibility="Public" Archived="false" MailNickname="sample-team-02" Photo="photo.jpg">
      <pnp:FunSettings AllowGiphy="true" GiphyContentRating="Strict"
                       AllowStickersAndMemes="true" AllowCustomMemes="true"/>
      <pnp:GuestSettings AllowCreateUpdateChannels="true" AllowDeleteChannels="false"/>
      <pnp:MembersSettings AllowCreateUpdateChannels="true" AllowDeleteChannels="false"
                           AllowAddRemoveApps="true" 
                           AllowCreateUpdateRemoveConnectors="true" 
                           AllowCreateUpdateRemoveTabs="false"
                           AllowCreatePrivateChannels="true" />
      <pnp:MessagingSettings AllowUserEditMessages="true" AllowUserDeleteMessages="true"
                             AllowOwnerDeleteMessages="false"
                             AllowTeamMentions="true"
                             AllowChannelMentions="true"/>
      <pnp:DiscoverySettings ShowInTeamsSearchAndSuggestions="false" />
      <pnp:Security AllowToAddGuests="true">
        <pnp:Owners ClearExistingItems="true">
          <pnp:User UserPrincipalName="owner01@domain.onmicrosoft.com" />
          <pnp:User UserPrincipalName="owner02@domain.onmicrosoft.com" />
        </pnp:Owners>
        <pnp:Members ClearExistingItems="false">
          <pnp:User UserPrincipalName="user01@domain.onmicrosoft.com" />
          <pnp:User UserPrincipalName="user02@domain.onmicrosoft.com" />
          <pnp:User UserPrincipalName="user03@domain.onmicrosoft.com" />
        </pnp:Members>
      </pnp:Security>
      <pnp:Channels>
        <pnp:Channel DisplayName="Sample Channel 01"
                     Description="This is just a Sample Channel"
                     IsFavoriteByDefault="true" ID="12345">
          <pnp:Tabs>
            <pnp:Tab DisplayName="Wiki" TeamsAppId="com.microsoft.teamspace.tab.wiki" Remove="true" />
            <pnp:Tab DisplayName="My Tab 01" TeamsAppId="12345" ID="67890">
              <pnp:Configuration EntityId="2DCA2E6C7A10415CAF6B8AB6661B3154"
                                 ContentUrl="https://www.contoso.com/Orders/2DCA2E6C7A10415CAF6B8AB6661B3154/tabView" 
                                 WebsiteUrl="https://www.contoso.com/Orders/2DCA2E6C7A10415CAF6B8AB6661B3154"
                                 RemoveUrl="https://www.contoso.com/Orders/2DCA2E6C7A10415CAF6B8AB6661B3154/uninstallTab" />
            </pnp:Tab>
          </pnp:Tabs>
          <pnp:TabResources>
            <pnp:TabResource Type="Notebook" TargetTabId="{TeamsTabId:TabDisplayName}">
              <pnp:TabResourceSettings>
                <![CDATA[ 
                {
                  "displayName": "Notebook name"
                }
                ]]>
              </pnp:TabResourceSettings>
            </pnp:TabResource>
            <pnp:TabResource Type="Planner" TargetTabId="{TeamsTabId:TabDisplayName}">
              <pnp:TabResourceSettings>
                <![CDATA[ 
                {
                  "displayName": "Planner name"
                }
                ]]>
              </pnp:TabResourceSettings>
            </pnp:TabResource>
            <pnp:TabResource Type="Schedule" TargetTabId="{TeamsTabId:TabDisplayName}">
              <pnp:TabResourceSettings>
                <![CDATA[ 
                {
                  "displayName": "Schedule name"
                }
                ]]>
              </pnp:TabResourceSettings>
            </pnp:TabResource>
          </pnp:TabResources>
          <pnp:Messages>
            <pnp:Message>
              <![CDATA[ 
              {
                "body": {
                  "contentType": "html",
                  "content": "Hello World"
                },
                "subject": "Welcome to this channel"
              }
              ]]>
            </pnp:Message>
          </pnp:Messages>
        </pnp:Channel>
        <pnp:Channel DisplayName="Sample Channel 02"
                    Description="This is just a Sample Channel"
                    IsFavoriteByDefault="false"
                    MembershipType="Shared" 
                    AllowNewMessageFromBots="true"
                    AllowNewMessageFromConnectors="true"
                    ReplyRestriction="AuthorAndModerators"
                    UserNewMessageRestriction="Moderators" />
        <pnp:Channel DisplayName="Sample Channel 03"
                    Description="This is just a Sample Channel"
                    IsFavoriteByDefault="false" MembershipType="Private" />
      </pnp:Channels>
      <pnp:Apps>
        <pnp:App AppId="12345678-9abc-def0-123456789a" />
        <pnp:App AppId="{TeamsAppId:APP002}" />
      </pnp:Apps>
    </pnp:Team>
    <pnp:Apps>
      <pnp:App AppId="APP001" PackageUrl="./custom-app-01.json" />
      <pnp:App AppId="APP002" PackageUrl="./custom-app-02.zip" />
    </pnp:Apps>
    
  </pnp:Teams>

  <pnp:AzureActiveDirectory>
    <pnp:Users>
      <pnp:User AccountEnabled="true"
                DisplayName="John White"
                PasswordPolicies="DisablePasswordExpiration,DisableStrongPassword"
                ProfilePhoto="photo.jpg"
                GivenName="John"
                Surname="White"
                JobTitle="Senior Partner"
                OfficeLocation="Seattle, WA"
                PreferredLanguage="en-US"
                MobilePhone="+1-601-123456"
                MailNickname="john.white"
                UsageLocation="US"
                UserPrincipalName="john.white@{parameter:domain}.onmicrosoft.com">
        <pnp:PasswordProfile ForceChangePasswordNextSignIn="true" ForceChangePasswordNextSignInWithMfa="false"
                             Password="Pass@w0rd"/>
        <pnp:Licenses>
          <pnp:License SkuId="6fd2c87f-b296-42f0-b197-1e91e994b900">
            <!-- Office 365 E3 -->
            <pnp:DisabledPlans>
              <pnp:DisabledPlan>5136a095-5cf0-4aff-bec3-e84448b38ea5</pnp:DisabledPlan>
              <!-- Information Protection for Office 365 - Standard -->
              <pnp:DisabledPlan>c87f142c-d1e9-4363-8630-aaea9c4d9ae5</pnp:DisabledPlan>
              <!-- To-Do (Plan 3) -->
              <pnp:DisabledPlan>2789c901-c14e-48ab-a76a-be334d9d793a</pnp:DisabledPlan>
              <!-- Microsoft Forms (Plan E5) -->
              <pnp:DisabledPlan>a23b959c-7ce8-4e57-9140-b90eb88a9e97</pnp:DisabledPlan>
              <!-- Sway -->
            </pnp:DisabledPlans>
          </pnp:License>
          <pnp:License SkuId="1f2f344a-700d-42c9-9427-5cea1d5d7ba6">
            <!-- Microsoft Stream Trial -->
          </pnp:License>
        </pnp:Licenses>
      </pnp:User>
      <pnp:User AccountEnabled="true"
                DisplayName="Jim Black"
                MailNickname="jim.black"
                UsageLocation="US"
                UserPrincipalName="jim.black@contoso.onmicrosoft.com">
        <pnp:PasswordProfile ForceChangePasswordNextSignIn="true"
                             Password="Pass@w0rd"/>
      </pnp:User>
    </pnp:Users>
  </pnp:AzureActiveDirectory>

  <pnp:Drive>
    <pnp:DriveRoot DriveUrl="/users/jim.black@contoso.onmicrosoft.com/drive">
      <pnp:DriveItems>
        <pnp:DriveFolder Name="Projects" Src="OneDrive/Jim.Black/Projects" />
        <pnp:DriveFolder Name="ExpenseReports">
          <pnp:DriveFolder Name="FY2018">
            <pnp:DriveFolder Name="FY2018-01" />
            <pnp:DriveFolder Name="FY2018-02">
              <pnp:DriveFolder Name="FY2018-02-01" />
              <pnp:DriveFolder Name="FY2018-02-02" />
            </pnp:DriveFolder>
            <pnp:DriveFile Name="Expense-Report-Jan2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Jan2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Feb2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Feb2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Mar2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Mar2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Apr2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Apr2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-May2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-May2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Jun2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Jun2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Jul2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Jul2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Aug2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Aug2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Sep2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Sep2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Oct2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Oct2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Nov2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Nov2018.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Dec2018.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2018/Expense-Report-Dec2018.xlsx"/>
          </pnp:DriveFolder>
          <pnp:DriveFolder Name="FY2019">
            <pnp:DriveFile Name="Expense-Report-Jan2019.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2019/Expense-Report-Jan2019.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Feb2019.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2019/Expense-Report-Feb2019.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Mar2019.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2019/Expense-Report-Mar2019.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Apr2019.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2019/Expense-Report-Apr2019.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-May2019.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2019/Expense-Report-May2019.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Jun2019.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2019/Expense-Report-Jun2019.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Jul2019.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2019/Expense-Report-Jul2019.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Aug2019.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2019/Expense-Report-Aug2019.xlsx"/>
            <pnp:DriveFile Name="Expense-Report-Sep2019.xlsx" Src="OneDrive/Jim.Black/ExpenseReports/FY2019/Expense-Report-Sep2019.xlsx"/>
          </pnp:DriveFolder>
        </pnp:DriveFolder>
        <pnp:DriveFile Name="MyFavoriteSlides.pptx" Src="OneDrive/Jim.Black/MyFavoriteSlides.pptx"/>
        <pnp:DriveFile Name="Jim-Black-Resume.docx" Src="OneDrive/Jim.Black/Jim-Black-Resume.docx"/>
      </pnp:DriveItems>
    </pnp:DriveRoot>
    <pnp:DriveRoot DriveUrl="/users/john.white@{parameter:O365TenantName}.onmicrosoft.com/drive">
      <pnp:DriveItems>
        <pnp:DriveFolder Name="Documents" Src="OneDrive/John.White/Documents"
            Recursive="true" IncludedExtensions="*.pdf,*.docx" ExcludedExtensions="*.xlsx,*.pptx"/>
        <pnp:DriveFile Name="John-White-Resume.docx" Src="OneDrive/John.White/JWResume.docx"/>
      </pnp:DriveItems>
    </pnp:DriveRoot>
  </pnp:Drive>

  <pnp:ProvisioningWebhooks>
    <pnp:ProvisioningWebhook Url="https://mywebhook.azurefunctions.net/function01"
                                     Method="GET" Kind="ProvisioningStarted" BodyFormat="Json" Async="true">
      <pnp:Parameters>
        <pnp:Parameter Key="Param01" Value="Value01"/>
        <pnp:Parameter Key="Site" Value="{sitecollection}"/>
      </pnp:Parameters>
    </pnp:ProvisioningWebhook>
    <pnp:ProvisioningWebhook Url="https://mywebhook.azurefunctions.net/function01"
                                     Method="POST" Kind="ProvisioningCompleted" BodyFormat="Json" Async="true">
      <pnp:Parameters>
        <pnp:Parameter Key="Param01" Value="Value01"/>
        <pnp:Parameter Key="Site" Value="{sitecollection}"/>
      </pnp:Parameters>
    </pnp:ProvisioningWebhook>
  </pnp:ProvisioningWebhooks>

</pnp:Provisioning>